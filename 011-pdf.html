<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="header.js"></script>
  <title>Perbandingan Syatibi & Jazari</title>

  <!-- PDF.js base CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf_viewer.min.css" />

  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #68fff2;
      font-family: monospace;
      color: #e8eaed;
      overflow: hidden;
    }
    /* Controls bar */
    #controls {
      display: flex;
      align-items: center;
      gap: .2rem;
      padding: .2rem .8rem;
      background: #000000;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    #controls input, #controls select {
      background: #0b0d10;
      color: #e8eaed;
      border: 1px solid #222831;
      border-radius: .25rem;
      padding: .25rem .2rem;
      font-family: monospace;
    }
    #viewerContainer {
      position: absolute;
      top: 65px; /* below controls */
      bottom: 0;
      left: 0;
      right: 0;
      overflow: auto;
      background: #ffffff;
    }
    .pdfViewer .page {
      margin: 20px auto;
      box-shadow: 0 0 12px rgba(0,0,0,.45);
      border-radius: .5rem;
      overflow: hidden;
    }
    .textLayer ::selection { background: rgb(108, 255, 118); }
  </style>
</head>
<body>
<div class="header-container">
  <header3-component></header3-component>
</div>
  <!-- Controls -->
  <div id="controls">
    <label>Page:
      <input type="number" id="pageInput" value="1" min="1" style="width:4rem">
    </label>
    <span id="pageCount">/ ?</span>

    <label style="margin-left:1rem">Zoom:
      <select id="zoomSelect">
        <option value="0.5">50%</option>
        <option value="1" selected>100%</option>
        <option value="1.5">150%</option>
        <option value="2">200%</option>
        <option value="page-width">Fit Width</option>
        <option value="page-fit">Fit Page</option>
      </select>
    </label>
  </div>

  <!-- PDF container -->
  <div id="viewerContainer">
    <div id="viewer" class="pdfViewer"></div>
  </div>

  <!-- PDF.js scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf_viewer.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

    const container = document.getElementById("viewerContainer");
    const eventBus = new pdfjsViewer.EventBus();
    const linkService = new pdfjsViewer.PDFLinkService({ eventBus });
    const findController = new pdfjsViewer.PDFFindController({ eventBus, linkService });

    const viewer = new pdfjsViewer.PDFViewer({
      container,
      eventBus,
      linkService,
      findController,
      textLayerMode: 2,
    });
    linkService.setViewer(viewer);

    let pdfDoc = null;

    eventBus.on("pagesinit", () => {
      viewer.currentScaleValue = "auto";
      document.getElementById("pageCount").textContent = "/ " + pdfDoc.numPages;

      // âœ… Set max pages for input
      document.getElementById("pageInput").max = pdfDoc.numPages;
    });

    eventBus.on("pagechanging", (e) => {
      document.getElementById("pageInput").value = e.pageNumber;
    });

    async function openPDF(url) {
      const loadingTask = pdfjsLib.getDocument(url);
      pdfDoc = await loadingTask.promise;
      viewer.setDocument(pdfDoc);
      linkService.setDocument(pdfDoc, null);
    }

    // Load local pdf
    openPDF("DOC-20250430-WA0018_250824_113704.pdf");

    // Page jump
    document.getElementById("pageInput").addEventListener("change", (e) => {
      let page = parseInt(e.target.value, 10);
      if (page > 0 && page <= pdfDoc.numPages) {
        viewer.currentPageNumber = page;
      } else {
        // Reset to valid current page
        e.target.value = viewer.currentPageNumber;
      }
    });

    // Next/Prev buttons
    document.getElementById("prevPage").addEventListener("click", () => {
      if (viewer.currentPageNumber > 1) {
        viewer.currentPageNumber -= 1;
      }
    });

    document.getElementById("nextPage").addEventListener("click", () => {
      if (viewer.currentPageNumber < pdfDoc.numPages) {
        viewer.currentPageNumber += 1;
      }
    });

    // Zoom control
    document.getElementById("zoomSelect").addEventListener("change", (e) => {
      viewer.currentScaleValue = e.target.value;
    });
  </script>
</body>
</html>
